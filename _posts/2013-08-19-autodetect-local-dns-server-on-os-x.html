---
layout: post
title: Autodetect local DNS server on OS X
categories: []
tags: []
status: draft
type: post
published: false
meta:
  geo_public: '0'
author: 
comments: true
---
<p>My home router came with its default gateway set to <code>192.168.1.1</code>.  When I'm at work, the company's default gateway is different (<code>192.168.0.1</code>).  This caused my machine to get confused because it had a hardcoded DNS server in the Network settings!  My immediate thought was to set my DNS servers to use Google DNS (<code>8.8.8.8</code> and <code>8.8.4.4</code>) which meant I could resolve remote sites but then this also meant my machine didn't know where to look for local DNS entries in the office and on my home LAN.</p>
<p>All you need to do is to NOT specify a DNS server in your settings and OS X will just use its default gateway:</p>
<p>Firstly, it's probably not a good idea to change the DNS settings like you normally would with a Linux server because of what it says in <code>/etc/resolv.conf</code>:</p>
<p>[code lang="bash"]<br />
#<br />
# Mac OS X Notice<br />
#<br />
# This file is not used by the host name and address resolution<br />
# or the DNS query routing mechanisms used by most processes on<br />
# this Mac OS X system.<br />
#<br />
# This file is automatically generated.<br />
#<br />
domain mycompany.local<br />
nameserver 192.168.0.1<br />
[/code]</p>
